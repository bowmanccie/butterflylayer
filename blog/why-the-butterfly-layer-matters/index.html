<!-- BEGIN: content/partials/layout.html -->
<!doctype html>
<html lang="en">
  <head>
    <!-- BEGIN: content/partials/head.html -->
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Why the Butterfly Layer Matters — L8 Blog</title>
<meta name="description" content="How the human layer – the Butterfly Layer – shapes architectures more than any protocol ever will.">

<!-- Open Graph -->
<meta property="og:type" content="website">
<meta property="og:title" content="Why the Butterfly Layer Matters — L8 Blog">
<meta property="og:description" content="How the human layer – the Butterfly Layer – shapes architectures more than any protocol ever will.">
<meta property="og:image" content="/assets/img/social/og-default.png">
<meta property="og:url" content="https://butterflylayer.com/blog/why-the-butterfly-layer-matters">
<meta property="og:site_name" content="L8: The Butterfly Layer">

<!-- Twitter -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Why the Butterfly Layer Matters — L8 Blog">
<meta name="twitter:description" content="How the human layer – the Butterfly Layer – shapes architectures more than any protocol ever will.">
<meta name="twitter:image" content="/assets/img/social/og-default.png">

<!-- Primary styles -->
<link rel="stylesheet" href="/assets/css/variables.css?v=20251203221751">
<link rel="stylesheet" href="/assets/css/main.css?v=20251203221751">
<link rel="stylesheet" href="/assets/css/podcast.css?v=20251203221751">

<!-- Page-specific scripts (optional) -->
<script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>


<!-- Shared scripts -->
<script src="/assets/js/quotes.js?v=20251203221751" defer></script>
<script src="/assets/js/loader.js?v=20251203221751" defer></script>

<!-- END: content/partials/head.html -->

  </head>
  <body id="top">
    <div id="construction-banner-slot"></div>
    <div id="header"></div>

    <main id="main-content">
      <!-- BEGIN: content/partials/blog_post_header.html -->
<header class="page-header">
  <div class="container flow">
    <p class="page-eyebrow">
      <a href="/pages/blog/">&larr; Back to Blog</a>
    </p>
    <h1 id="post-title">Why the Butterfly Layer Matters</h1>
    <p class="page-subtitle" id="post-meta">2025-11-16 • architecture-l8, architecture, mindset</p>
  </div>
</header>
<!-- END: content/partials/blog_post_header.html -->

      <!-- BEGIN: /content/partials/blog_post_content.html -->
<section class="page-section">
  <div class="container">
    <article id="post-body" class="blog-post-body flow"></article>
  </div>
</section>

<!-- Previous / Next navigation -->
<section class="page-section">
  <div class="container two-column blog-nav">
    <div id="previous"></div>
    <div id="next"></div>
  </div>
</section>

<script>
  // Values injected from devserver via "why-the-butterfly-layer-matters" / "Why the Butterfly Layer Matters"
  const slug = "why-the-butterfly-layer-matters";
  const pageTitle = "Why the Butterfly Layer Matters";
  const bodyEl = document.getElementById("post-body");

  function stripLeadingTitle(md, title) {
    const lines = md.split("\n");
    let i = 0;
    while (i < lines.length && lines[i].trim() === "") {
      i++;
    }
    if (i < lines.length) {
      const line = lines[i].trim();
      if (line.startsWith("# ")) {
        const headingText = line.replace(/^#\s+/, "").trim();
        if (!title || headingText === title.trim()) {
          lines.splice(i, 1);
          return lines.join("\n");
        }
      }
    }
    return md;
  }

  async function loadMarkdown() {
    try {
      const res = await fetch("/blog/posts/" + slug + ".md");
      if (!res.ok) throw new Error("Unable to load markdown");
      let markdown = await res.text();
      markdown = stripLeadingTitle(markdown, pageTitle);
      const html = window.marked ? window.marked.parse(markdown) : markdown;
      bodyEl.innerHTML = html;
    } catch (err) {
      console.error(err);
      bodyEl.innerHTML = "<p>Sorry, this post could not be loaded right now.</p>";
    }
  }

  // --- Previous / Next navigation ---

  function renderNeighborCard(targetId, post, label) {
    const slot = document.getElementById(targetId);
    if (!slot || !post) return;

    const date = post.date || "";
    const tags = normalizeTags(post.tags);
    const summary = post.summary || "";
    const meta = date;

    const tagsHtml = tags.length
      ? `<p class="blog-card-tags">${tags
          .map((tag) => `<span class="tag">${tag}</span>`)
          .join("")}</p>`
      : "";

    slot.innerHTML = `
      <article class="card blog-nav-card flow">
        <p class="kicker">${label}</p>
        <h3><a href="/blog/${post.slug}/">${post.title}</a></h3>
        ${meta ? `<p class="blog-card-meta">${meta}</p>` : ""}
        ${summary ? `<p class="blog-card-excerpt">${summary}</p>` : ""}
        ${tagsHtml}
      </article>
    `;
  }

  async function loadNeighbors() {
    try {
      const res = await fetch("/blog/posts.json");
      if (!res.ok) return;

      const posts = await res.json();
      if (!Array.isArray(posts)) return;

      // Sort by date ascending so "previous" = older, "next" = newer
      const sorted = posts.slice().sort((a, b) => {
        const ad = a.date || "";
        const bd = b.date || "";
        return ad.localeCompare(bd);
      });

      const idx = sorted.findIndex(p => p.slug === slug);
      if (idx === -1) return;

      const prev = idx > 0 ? sorted[idx - 1] : null;
      const next = idx < sorted.length - 1 ? sorted[idx + 1] : null;

      if (prev) renderNeighborCard("previous", prev, "Previous Post");
      if (next) renderNeighborCard("next", next, "Next Post");
    } catch (err) {
      console.error("Error loading neighbor posts:", err);
    }
  }

  document.addEventListener("DOMContentLoaded", function () {
    loadMarkdown();
    loadNeighbors();
  });
</script>
<!-- END: /content/partials/blog_post_content.html -->

    </main>

    <!-- Back to top / subtle footer helper -->
    <section class="page-section backtotop">
      <div class="container">
        <a href="#construction-banner-slot">Back to Top</a>
      </div>
    </section>

    <div id="footer"></div>
  </body>
</html>
<!-- END: content/partials/layout.html -->
